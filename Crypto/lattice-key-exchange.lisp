;; lattice-key-exchange.lisp
;;
;; DM/RAL  2023/03/24 03:26:29
;; ----------------------------------

(defpackage #:com.ral.crypto.lattice-key-exchange
  (:use #:common-lisp #:lattice #:vec-repr #:hash #:ac)
  (:export
   #:lattice-skey
   #:lattice-pkey
   #:random-key
   #:make-aes-packet
   #:decode-aes-packet
   #:make-connection-to-server-packet
   #:make-connection-to-client-packet
   #:decode-server-connection-packet
   #:decode-client-connection-packet

   #:cnx-packet-encoder
   #:cnx-packet-decoder

   #:my-pkeyid
   #:srv-pkeyid
   ))

(in-package #:com.ral.crypto.lattice-key-exchange)

;; ----------------------------------
;;
;; Store skey seed in system keychain with:
;;  security add-generic-password -a $USER -s 'LispActorsSystem' -w <key>
;;
;; If you need to delete before adding:
;;  security delete-generic-password -a $USER -s 'LispActorsSystem'

(deflex lattice-skey
  (create
   (alambda
    ((cust)
     (flet (
            #+:MACOSX
            (get-seed ()
              (let ((txt (with-output-to-string (s)
                           ;; Using Mac KeyChain to hold secret keying
                           (sys:call-system-showing-output
                            "security find-generic-password -a $USER -s 'LispActorsSystem' -w"
                            :output-stream s))))
                (subseq (cadr (um:split-string txt :delims '(#\newline))) 2)))
            #+:WINDOWS
            (get-seed ()
              (with-open-file (f "~/.my-syzygy")
                (read f))) )
       (let ((me  self))
         (β (sys)
             (send lattice-system β)
           (let* ((seed (get-seed))
                  ;; (skey (lat2-gen-deterministic-skey sys seed))
                  (skey (flat-gen-deterministic-skey sys seed)))
             (send me cust :update skey) ))
         )))
    
    ((cust :update skey)
     (become (const-beh skey))
     (send cust skey))
    )))

(deflex lattice-pkey
  (create
   (lambda (cust pkey-id)
     (β (pkey)
         (send kvdb:kvdb β :find pkey-id)
       (when pkey ;; if not found, just drop things on the floor...
         (send cust pkey)))
     )))

(deflex lat2-encoder
  (create
   (lambda (cust pkey v)
     (β (sys)
         (send lattice-system β)
       (let ((enc (ignore-errors
                    ;; (lat2-encode pkey v sys)
                    (flat-encode pkey v sys)
                    )))
         (when enc
           (send cust enc)))
       ))
   ))

(deflex lat2-decoder
  (create
   (lambda (cust cs)
     (β (sys)
         (send lattice-system β)
       (β (skey)
           (send lattice-skey β)
         (let ((dec (ignore-errors
                      ;; (lat2-decode skey cs sys)
                      (flat-decode skey cs sys)
                      )))
           (when dec
             (send cust dec)))
         )))
   ))

;; ------------------------------------------------------
;; AES-256/CTR Encryption/Decryption

(defun random-key ()
  (vec (hash/256 :random-key (uuid:make-v1-uuid)
                 (prng:ctr-drbg 256))))

(defun aes-enc/dec (key iv vsrc)
  (let ((cipher (ironclad:make-cipher :aes
                                      :mode :ctr
                                      :key  key
                                      :initialization-vector iv)))
    (ironclad:encrypt-in-place cipher vsrc)
    vsrc))

(defun make-auth-chk (key iv cdata)
  (vec (hash/256 :chk key iv cdata)))

(defun make-iv (key)
  (subseq
   (vec (hash/256 :iv key (uuid:make-v1-uuid)))
   0 16))

(defun make-aes-packet (key &rest data)
  (let* ((vdata  (loenc:encode (loenc:unshared-list data)
                               :max-portability t))
         (iv     (make-iv key))
         (cdata  (aes-enc/dec key iv vdata))
         (chk    (make-auth-chk key iv cdata)))
    (list iv cdata chk)
    ))

(defun decode-aes-packet (key packet)
  (destructuring-bind (iv cdata &optional chk) packet
    (cond
     (chk ;; a normal packet
          (let ((chkx (make-auth-chk key iv cdata)))
            (when (equalp chkx chk) ;; just drop on the floor if not valid
              (let ((vdata  (aes-enc/dec key iv cdata)))
                (loenc:decode vdata)))
            ))
     (t ;; an unauthenticated packet used for initial handshake dance
        (let ((vdata  (aes-enc/dec key iv cdata)))
          (loenc:decode vdata)))
     )))

#|
   -----------------------------------------------------
   Secure Key Exchange
  
      client                                server
      --------------------------            ---------------------------
      Random Kc
      Ps = Lookup(SrvID)
      LatEnc(Ps, Kc), AES(Kc,CliID)  -->    Check CliID for membership
                                            Pc = Lookup(CliID)
                                            Random Ks
                                            Kses = H(Ks, Kc)
                                     <--    LatEnc(Pc, Ks)
      Kses = H(Ks, Kc)
  
      AES(Kses, Data)                -->
                                     <--    AES(Kses, Reply)
      ...
  
|#

(deflex cnx-packet-encoder
  (create
   (lambda (cust dest-pkeyid &rest info)
     (β (pkey) ;; if not found just drop things on the floor
         (send lattice-pkey β dest-pkeyid)
       (let* ((rkey       (random-key))
              (aes-packet (ignore-errors
                            (apply #'make-aes-packet rkey #|:canary|# info))))
         (when aes-packet
           (β (lat-enc)
               (send lat2-encoder β pkey rkey)
             (send cust rkey lat-enc aes-packet)
             )))))
   ))

(deflex cnx-packet-decoder
  (create
   (lambda (cust latcrypt aescrypt)
     ;; During handshake we exchange pairs of packets. The first is a
     ;; Lattice encrypted random key, the second is an AES encrypted
     ;; packet using that key.
     ;;
     ;; Return both the random key and the decrypted info.
     ;; Client/Server differ only in the contents of that info.
     (β (rkey)
         (send lat2-decoder β latcrypt)
       (let ((info (ignore-errors
                     (decode-aes-packet rkey aescrypt))))
         #|
         (when (and (consp info)
                    (eq (car info) :canary))
           (send cust rkey (cdr info)))
         |#
         (when (consp info)
           (send cust rkey info))
         )))
   ))

;; ----------------------------------------------------
;; For Actors-based code, using parallel Lattice encryption

(deflex my-pkeyid
  (create (lambda (cust)
            (send kvdb:kvdb cust :find :my-fpkeyid))
          ))

(deflex srv-pkeyid
  (const ;; "{d73be812-5309-11ee-9c10-f643f5d48a65}" ;; for 320x256 1-bit system
         ;; "{030DB608-B3D8-11EE-A642-80FF8DB0CE01}" ;; for 160x128 1-bit system
         "{B2DA77DC-B596-11EE-8E31-CB2DA3737401}" ;; for 160x128 8-bit system
         ))

#|
(inspect (ask lattice-system))
(inspect (ask lattice-skey))
(let* ((v (vec (hash/256 :test)))
       (sys (ask lattice-system))
       (skey (ask lattice-skey))
       (pkey (ask lattice-pkey (ask my-pkeyid)))
       (enc (flat-encode pkey v sys))
       (dec (flat-decode skey enc sys)))
  (assert (equalp v dec)))
|#

#|
  
(let* ((sys  (ask lattice-system))
       (skey (ask lattice-skey))
       (pkey (fgen-pkey skey sys)))
  (send kvdb:kvdb sink :add "{B2DA77DC-B596-11EE-8E31-CB2DA3737401}" pkey))

(send kvdb:kvdb sink :add :my-fpkeyid "{B2DA77DC-B596-11EE-8E31-CB2DA3737401}")

(with-standard-io-syntax
  (prin1 (ask kvdb:kvdb :find (ask kvdb:kvdb :find :my-fpkeyid)))
  (values))

(with-standard-io-syntax
  (prin1 (ask kvdb:kvdb :find :flat-system))
  (values))

;; ---------------------------------------------------------------------
;; To be used on foreign nodes...


;; Provide the System Matrix
(send kvdb:kvdb sink :add :flat-system
      '(:NBITS 320 :NCODE 256 :NROWS 640 :NCOLS 1 :MODULUS 2135987035920910082395021706169552114602704522356652769947041607822219725780640550022962086936379 :NNOISE 57 :MAT-A #(#(1369767694720606694636771990490938593677143678809599913282629321734024710208266467274640149262897) #(64178052858530706411093900568040610636072576425988757535949399332694708768613990738870368852343) #(73046632017246288415397740675071400521794248315399746693956147337452460522306402784372839530281) #(2067862062356449476724337141556300153632585340305373535709587887543701713077430142380889826497573) #(710983825062088822685194444030324577647904176009811082079185396667210399664193943854248697166571) #(2024240812815583633042303032151846466129713208066595085041464290664130349649169329087489455442851) #(1154193440564012924811455289718469057417577522780816212314636679495179322535876172133600018736812) #(118946899882594675839989301583373362832781179190782521546611607867161748570022051247679503864772) #(1064721600311027472273107476357149356947571663499997722510181991077506223017982946787428387623123) #(881929642890040011536717454947977792021061840038184729339638020441132688480597477823567362002367) #(757276987398952831172969908191664971400451928901401321460741919581895517058319183338583710153321) #(1382924906066572835318384899701818760804371246987529656482725689841265066672003804215127713614410) #(131793417361479718319060253827595013265367987825544369313935823086971022113921266241707821026999) #(860248614634197628085383231786391050857643293867298668056776286547935994377943827677851608363493) #(1104425256905890792246753352971038300786318608591424838364371121506988527319258833784148563836548) #(1461388034806857853833578099064552381411475821608154036610367583353547113499844774009665577675577) #(1472906174778878298882550919927365829379901209811902001466055426979378119465126097163537857812648) #(914585183249246118613512920570560133730651017716792567070388701153928087827891512554808647231402) #(1322557840466335489045928137754566023211321775051856671087726936055796026409973570422301373953720) #(191766940878737212321663408817065375929134618191635558616860088167483352750680921135851304769652) #(427996454280859751494305976903307368886314802516305193283413457178798378839352342173140034616787) #(1099770952791280049286403927399937368316553024572180727520287389634083174185768643646845744679878) #(1395472208916231793499121326078677338995614826025432751770814192760953257926678820725603221023584) #(1741700456262070043895644168278370798453892195550294123497108006866258764814153290423711632056045) #(580856980982078414807242834944747284219638501698883732270278698405460162729678395030283707893945) #(778972400537216900664729779745286594122380767748848274135426177994762127273017240513184244136390) #(1559602293907236000937368848081293970154715732731212498239078480874031082937110749826590848476763) #(1114937684165543015897532910910638067652816427708209494596680570750581255942108243369646943193410) #(1346963236762003753780060138146811398527143330534827865036191727048367060429348843657762801990652) #(621795113547736111400990629265806717173338088517430471762719547491569641826584467296523306146455) #(1199426968515078961139312792553357305278760452473618119649373764295926047743353450033333689970374) #(1498792537692923626606085783098088005489222135582746136067884696844094097558622880345764463401767) #(539353886768459187061960153383004522843351382796666597398981239498103276473125215328575727832957) #(1538176521745872264134768222772486786630249523611804292138393896306879480684248209915621675522931) #(312092157636283307315750942946964761910640274163805877817292106458458484645029865237422502263728) #(1115516467963537559644446519872005670716359799010522042587585105394413801021508767535243297816413) #(770200770017615177684536472135383055065567593850144977569720944143140589542671827643675642424748) #(195249972640447418979560034511588491506555943808168475523401610186222270748334970600560922508999) #(135433693294859536621937198597122158240563052354016227957435861153479260302062447197415625424677) #(233876786479985050349146424074276496776049957698970916825551957667498055784064609391375411413111) #(258901285772685948443113895050148954796935807334422418413580305549037639633804226825133680449372) #(92281261611621654466141394469295574448239957708605035426890833524098446659844640587720129182626) #(1410231603506369475465087370006166140202385750389423979582013253671764179371275521988104621339172) #(6253380760108303509910973633261955576788250752104386975997040264134224375633912264277951273493) #(1233473060110348100513709377753422751410412387110870094897403087416498955782885826799505836021739) #(46457932839234980671711854700853772414947274139634583584700444623633450218069907905255099830055) #(1969746333945498631251558191906439014287308978654415592664360779781221002191255510748352514831065) #(1885957758206974343345646162930008255508547350455323688657366387454716291724959607776177085098982) #(35583646682993791455893186069493321458317125411983617105206347741010648081058098539546197147387) #(688234833790257481410714393400735360629399145560597823960671479667062580790066262780935290030764) #(555510735608258101134728786242621334465820009394460336763240049786703063919917110085169978532206) #(1685991172191986175165449653157620610617373500367371392870658914862968284425806091634229737405806) #(1999861598379205350971894169747676124302037839413477359049768882351287189156628665340089374745844) #(1043264045616476963679336763833767014078775755000265423647715559340014063559810727435340316437030) #(1136268688861535288009470740897270114331656640694245222667385757582299020740411695631708213315135) #(500928382938453768043192168753304919750601759772466983110657388469474121765103110766862916041937) #(1829090485032598185315741695609477306578895313381650501537555649994757587398203137320620198393693) #(1097480202615337630349039990542176734234113535527885078486781361191091874290666751848667575350257) #(1740297926425139870405721387430626008089901582316269140601603511551309442616813879402271426914589) #(1259509468361589592536496295376479584932469440886159497502237969054015754331436128530074015277890) #(544670464149861181887138822795567982129273139896235718719531853797555806103785560951809057328344) #(1074686661827137950823553575813349406802318640507987615219780774951943033146991780750750423970905) #(610748350747399242382487146029738506096032915547982421888876707002699396284426157190990201042283) #(951733680826229383268441090857259100626215748377754666652770229231821834482047918296923221073008) #(1738962250240499399520809406942788731156248928858938148336181896617551827855980314925460777350807) #(834962426130215298049529436431988855256331007457323890237061269483316637498868669163083754583751) #(1596997953157429768162537628639787582423300654241792079196212003236340445181222344312525761424643) #(1505631801079985982210647432914134330748406048756309620556694123146825304283800077334344797095810) #(1554675351940391563679673523699486522762674831374941461479288856629662264199650620811693038675763) #(2120537685038608558231935798370536358917816681905395264164733529548987048951789972459141325824850) #(181607820487967850482694491496923262562629529247612109607979929567215275730093282065203590538029) #(2049590691456434480387606561358443170892473089203130680002756527217775189969074254569690364644596) #(1689801053305167785929976984177584465793296530653514202799319922470992428607904068447389029575066) #(824438878799430133521511058580345103654051226572691628840344560416308157157017055944200074315768) #(1017684306782818367964026672123333300365892333994342723692395839774486060462729036202455947712457) #(565030922946851877899596157311908222447417294533847473149124294100419169659429360822683940161399) #(813662509606170666546447244200713949939650354601263742042508040087734296413217442171520384968279) #(572525961392914144987032290830824244324804308959247787931601209823846072058039863290287957547528) #(1140706429540467342498723114428898231017694004774382010942251896211044373337662406671280254339339) #(2109033842855934588609435714614064812286185416409529192710538469654484249750550922462855866194616) #(243060565242485236387475502545442893235812208814190809933258558424158876063722735099798443600642) #(1393632276274246338861400554923337211002991131878752453202222470024240516332267687893680882260449) #(1673482148575027711259549823509071461950070104011316132563585259199081294993839674133613163756770) #(647431346836109236235656538896630983276484113281189585681691904116629143691749363378192392968788) #(1641242016203577346738240596683204089267552381524121116692701075867131528730065468045015229156043) #(2081835208975545219894651074119162513828895040423866229168915847434701227933239142527308737257269) #(548002983670342960008850764849583451648829074258300263414795186448846264431863498889381518279914) #(273207459274414174473661576246460117775283868797626629444639803544051084031209619033792607913666) #(2079765350330262630909217811543722154186986749017540532210699130381911283551311335146477788325090) #(793111910740377788245946083272495876657393078256901361432082872329071507328781311053609590643613) #(772496400905793243000867193417313495053577762296836733068595653731951044361870205993973964824898) #(1873829366548728013768379518907175808430205783515325127756877423208539600238921848187792061346344) #(2042288373865762447633749890040573217406056446864966603314220494723335065555424479897992012141580) #(566335540964075562530006041070645105986453510534345958698723902656434080071211323037527581828560) #(65713398357495313784433484976210496247208031425481663841968022312563624187452422236472607023050) #(1479977767331301644843352925690373429547798310556304174042157408125027731667531795790339077570609) #(1581094483332708861834736568798703721762621532724489162390059318692338867400041542808550752049081) #(2075470097531380463670843097280721438066768900943181698927589711528408700194672755382938750331289) #(2017215003649183388820396205138229441660875711518136888650044871449111856014630492980439233071680) #(1840562605762141293033409614778748182040368110580407892802092759688342469503219150278580583704551) #(1926147708851905983230598940457890943737239879719029002564440887232900933424522524083631636319330) #(1571176435469681636953528948785450761350737767374375092523339761855058366839207239229919220444691) #(568162230785329078318207409948064576322033039980970708774494838247048083197255809902990458626573) #(1261694483802197843941861231975371907131743968440200067935325186544527114299412621496703071419971) #(1877985402128015113523376586491133198933275246570353532527808325403282646282737453050263429045657) #(2011297502287463480487548308346576585588835149429535774981567406816119293861629565512332127194424) #(668658913909404240861964433200626848084409076677331287496284440100802898702504079028411978067430) #(1277273003548965406225098624419617620358678396652159984396812884526923356372476201798098207848884) #(1125595531763645646408404500225995865079855090262529848328227589335373123739785416676030488729225) #(1811481672077254739018906968746946851131370878439478887370011087471607919124346242606396999279229) #(1859328730960179622670861944725641991927471316501013047365341124208956010962337305150908086030369) #(266725518351281535410372953817130544178492611100185664136291469673287290411308031458386370321895) #(674010550551212183662213504662002922597238164582736302005903376118957137211353938429258518549700) #(567312087218008941126700012331878709657978053938788823711943109786188966419287621969191461191993) #(1525569130202537533719185235124107910861158461441465823788411421007324259723357801108876851735089) #(2119280105869371320622957604192199944899584769992244539543621894876768245448955668573248248668653) #(1555879436558744782881611061677590671629045893262120704512618940515890268353364730990617761196391) #(287420964199812226345125891887811399506429908823357641111471088055742086034167606196888310895702) #(928531561432529130916216541811052414399466238991248601950377075878980681780035263471085325298598) #(1639912767340603195225996450386419346925689167042188230687169740406496688529200162200119738168186) #(1368775275808052368298185644764094595932166321004061931711878911936825176375578701707871883375726) #(1149224470454251879096052949216710303884202390485589267578561721194251323433799004264009080311499) #(1108354627906034265246021058399413663148552367115414793292709568283511221009772226335973462347691) #(708954756071181820909378368444420081970787968834776295117277798206060708286659635411223949766841) #(1538819289268389989948799587961864416662659023521289569477703767312474068015658853991145919009916) #(865484223488316502370855658575784663093732764861224638899687361705970980025647172985758321116980) #(1976739481599178893665867929768624855076238715566729859105319740685933480442449223881747257632001) #(1017749395877612730030878424592624046585376407187428628537967571609226164504014993836065807844329) #(1635531597642325549318953750311910360200983376182689881762218874057170846387072650617174247159660) #(1631968365044699260582327056407283348477012283257758201585969122926614119970493049603187117691537) #(602522983167937851016508871604251383926528683184348509620314822937074479171306478713885306517997) #(1034527963468716664162386380961981967956138028534779557040242407725855588901192492348270594331178) #(68079446131762200221053347666697407966840292123486316413746283378375165233983432150689205972265) #(1129131404829144541280926419106186213845297592933457209114165231684782973264387352577659497786773) #(679178928167431706410286925890051221647881184244085446269602082435911322614595189578563246896157) #(2124374153946361548519001761570977511987925900576209629005356326340381705146905967687256532215525) #(996780042405632038455597530542440757190045937175104802184377024984445623805831889137523189947530) #(392420957016897732094619042241833797370642281243527586933608572951810445959823240262312131352054) #(1137530051420319302441111269854258657051568937552697525633516204187338161627418946306966158695776) #(1180603008254297208825774181702352641967713588719025254137747048403097862510046429649858225344558) #(38221093824807610775485144932713620210081488733081288013957147586274574550796962545901982060083) #(1646030145676773555618664372058737703931182091487542218753880483156500404490812662633274918463682) #(1781771928403766730117820420700801846973377444849217421735264144190889261296940499669100550303245) #(1123742280186884950530598235481671413535377246527957498490583944160825947939305879580645878585450) #(1349067872596046625609506512893844238515311965736843378267252417805893234424033755331134272096741) #(1066394776683750175478725453021837627354362629802470435435730621491561758134500610622760612951906) #(694729768285229380261107393508313130790354192098395488788014749753773566182919686368356938278965) #(396753174885045317452444852314904743012902467395374232012521900665475334292534329260132690171575) #(266541903267100890347241050210709399588993644829662686467380717995352928748649479495370877553725) #(1462225238239119607837917671175389178517504974364008859118385786806393125593288918935866879525067) #(1498608640893348515450885097384202195523521380927158034383275328431304218590583872819331738492274) #(1176808823140558509421430608162300777537315850535687560199233881255060745773674883616572821910856) #(260963254838063484088162985768638079497075374263023506011938810653002027234739994640486578068308) #(108594501612783286135489717383336430383220975607980856068298484039919951136098221167429989854963) #(1706258933859803574525040372579101773383907614208098099115592447838412084179940481737252449043889) #(1539528881315955101780297190600263459499541707236829241761796772846976482171798052136830334996929) #(418926300228311647629826069106094906847505029602411564621625477832930995976370139799864807336225) #(606221131105587755547949738163120689884264567874553654449598805724221025757785928952840314113579) #(991414735988217496217928884422670646362749589554946630692685101586271894223645533877917789430143) #(1739555552018628888907812732476690280324032474430708991817042780903980741865008995341859828527505) #(744861456040575226625043346813027724872724779226369594838107215934192414543216379560788846536413) #(655867936547925218303625067162186545365230285188660271395393513028839923745797115354437614221080) #(1964155331706010794552578154057551774259705728831158524156668501125244922975785965538910662774198) #(1004970968320913313887793199850368268547371728501966102137592687600282231141391310821503337659906) #(52027946252299247374152702231124481192012548350830764870759296450823004760854851440173244935687) #(604382909213519737660317138720312977220883376740333464636983437896080109203510833279776289030177) #(1916841167492777256985068145194361609040441306073135948776066513609754055283234356399730778187058) #(762962897858105112266458138545715114788369293876050349021642466898218704178174012643214588705554) #(1916624681024198559402654787789325966608898378901975195116400424722241722238804964758036930584521) #(650125587951665176980933670781401571103089941520294677686104764398529165020485101101043931188268) #(1045861153285293200272552266918472077233577284966975660260470479148290747404881835277917232829077) #(1031579684455997784616426432694565666962463085902282391127463616923936669996349197102265774216425) #(1406827598306801422900146664878397566636656189295200471037238621540800642598593656344353846195048) #(1489897928300706022357967035491812550281370825061422352599217512219729868987800482611163699180518) #(633001875321400258462530820317440807955467549348686619563816357036912630362295129485901434594415) #(950027269075150965811176408657806988733794472037641415762567367911153108255630546492028665347842) #(1600863314286653637697688346788306149056096997121506386042142362216582230541459482566123010742755) #(1924222115471876575952351842895082361113103740804403327132981750904461102120243280351834507221054) #(541809522801695009475358969438793744818421703069080849551554020978405931179420342930161789043197) #(1764992580457312645969068189671890037275029368125579223463658426852613771102854237757059186618089) #(365116379508955949703836785382191047171039267921436675218537817858992669419997291203651659277527) #(1409563343983788684823169217780490622969773643412036394458842361261067118046722303374202952865274) #(1873323156690335098661744005178719677148380250947585980799982032221714965889302881613045612884157) #(1937353135071846272111286422063872330655134170384520074444483169019238050002874366895866170147914) #(468840791772411249137215104341083753288207115487143412187637938355616209344003618777145855358904) #(138271001201524394430906488593006045977404027324731235229835245490552652654180338700024093537278) #(1667215133443140697389465906539474230984507556124393310678320415743944310444355540350147506574247) #(1120210876202684149209399965224490235349835778694698225944057801045060160905278030313785479971407) #(1552535232056076556690815567169567714444620253985786823729106728287867080486107970586286277378512) #(1773986926825768326534803956273259710427377436088669495573489421364295263578590707974703400909533) #(303097456549616014723415984495929187802109893653617708752267034657788771009632078019603483225231) #(867580820955418427846579432001379118152913680233198123374797215411404975691858550188127207823944) #(508497836614287492031401504264869168032642768493373116531535117656957776636300150185464650314252) #(1434427692248955959951389597062181378456925711358507935415941948596930098368894389137217455024471) #(447002444902455160435846891396015255154873741944822857579496043201021133932987062143523815639616) #(877665059370297773930608754679868107148263792614220219623388699266340956520681501375291061175766) #(679373354760750281409904429086136369357072800578160311228814031346016363053188633637442464583356) #(1714336088820010278144814915863182433467054100685466214749890266062145397146276626884072654406376) #(1306081885465334237132713393290247564509589601765681634889981538288752860019689478231257403026066) #(626594725806375453760535796100112283201577547244513651332574002966405602821772931861718273643958) #(1305216839214425307402273938918483102028633178340563512272577255652563145864540942637557425248065) #(1630039294270499863262349439968055047191972939019721910844122580938052070674381401946587002297578) #(1365251954161454932324872331774307223930879248392599205754132212860647945794098151702896124142546) #(156715428274388830310848207366666077091046214348449598542027310249075645648879552123718582883216) #(487689189674452742851829644235363309011325690760154049899111817357927002583550807634616017062870) #(1390009497381518312698381867591884507749124646990322148449726300155108174564486745485530218913977) #(194261632882035924443457758578367648546562689434432489840489590997418399897077607634452138534538) #(779294557042081192249141650479126144684959917653857342282737957692718969312076339272912715372099) #(502707575092641113303842609979406620792595560573690394329987869109199242284426126108978877459505) #(8801710153582512786287587252089552943541430688141163857778516327762793736453248735109815049149) #(1911965926613116201762878367852866319937987051414594493376027426474367825876789472692119170137974) #(894017387825481089530887524505456139371732065503447963863864033905138385838830463763325201184943) #(1251171890124380180540944284846574093013099061019503180513829804717620913490180792875836621848250) #(1527011113705490496010449148505129249250856056134392179731911617149598399911644403262225427643499) #(1534932441383807634840327048142656631936133417655147367058070353385564729045069293632409521337909) #(1997148197885211838520089433897060352642941331073637929933688951926634699224791907746711780221025) #(42628631507562799169166714551363644416962184395652520784438298922915744694948102656239522328579) #(721960111661527326053813869499980291783498705211185331269709888794758466970197113260636453380615) #(1037621086801366690917053237106507724972484635760831622425734244462663605896850764692137213498474) #(1254129158203115387564415797929490355703293589622830352886361503997273463873155421067136946140595) #(308681813106444405626800712484571946234574758750929515546757482699666335291993141032161170769273) #(1764468870726935623381326119967206573193776537886125349667915766554365742895316227557788349300210) #(84487776822531776660133128527947817646301728689098526369991922490917043953259575233025991538116) #(102718300288358229385573644666345676706241790400403736168920756619519288530109103724046416200064) #(334475887494084941352487593308981467310168346103417496752145193213587939954279857360754734498065) #(1019772213416202069227994476202869145617765362995569331841697846188047403775652904876291621452597) #(449043816043203588117857831282254935427520366103334764284173442827924448977853901704637194480827) #(578102052258958241380182979702556385757583326087369118043204852871901442740474689353278481914741) #(112352123447836066682515371645739988770508089328903475889413102661851275793726720050010269232348) #(1498748738423946984063597278552310869817018897853828589297501385623738982062049272131054647425253) #(880907437973495302159943761369716781017515284911802312313455087246597089201802643984805089147432) #(461203421665432863366903683771658319335795873004229030712353191891432714517019143312490408261711) #(983195079887369567669276943350413897958343459173658451846346316490286742758377906919009279263995) #(1569267220268833825824078208791356354035486633523345630748764562219895843875536722672810202726586) #(1768434226673346142469118156226409800562365786033816647099329850637871601170004121604271383757451) #(192299799569110688343329841097721957725556238551435507535727064745191810456638149489033531515078) #(563674987769777017386985339939338454306628890953008840465785093875107209498152766337186110494059) #(1037630961611373323552754387280744784807454818572912704930877308519894340559384753744279700157954) #(1236320240590951069222326275492122523434187811606860679959131665133018785621076749309319751735304) #(1150976101994789728785184264512020418768721384899357502768452065211773793626453739183538055803891) #(307655114615921588685404581930742808338893640394437678615289210625432444067773473242055215382435) #(771706901745826890435707941256902678409059037726390179378021360158438071349864287324975910509630) #(1114931393581521077409281528733622574881921238953479804867069282544391342987987016160010622207051) #(1907747321602547708616645018808066467737066417663491793671777771371834519544150338141050757125006) #(494948986537042223645989597684902562119460105414797725284223687377511043246307303570984469090224) #(658059363872708229476993525378780642601017562501033850992337152771292879443091682186277765483842) #(2107521906483487586576444862285026849768869755873002895893257517378086740262597902051048748536806) #(565488534344583838726518333827637324955992586983274840756947674235186449880095165285645815517039) #(1252185465215247868708461097427622895202073808281661255198025757778531267235541710600819664091812) #(925348415933498139742219387528381101365106482160484729565332889198821770801119968530965224617907) #(1639105756170953762693109790462883359314320685302722307799195986435478028724164024959967655155143) #(1434107057631323481946686953907269414310889224027676818356943729035278113415258976166024056731165) #(2105019282324397096527599898723617979526169406543293697082366101166880269267377815774358827205491) #(1947967916388669632235740237348468790725562246292118887923617633610978813571609139060016961365992) #(2026546552707092653013706524799347714155976122471117089584268109437135177185289800302428638780358) #(1072315209831971498458265581793504219515810953420634939312725380700780430366314950023544073196164) #(1979019749898586352629835667809991264277701056605718304365934416458502049085901174126684225474985) #(411054173877957071932983001629347424668538320708426396613347480107789879203365808271467895859642) #(1424427699593873478643692510220954943003025683309850414269019321761176996523243525519099380654477) #(124738293857570593576372899549866445227789651785852761166646313245853332663942770343492640799924) #(1796201616992130854153397213618319767811256943615361994290206352566874070079303096552764562307288) #(962688190089673919443003377643672071858758504058984471208878332802146520816068805708561026153108) #(1748892059351238690871655204414736916455361188616042143027659030389320453990416690842322745861183) #(1387318480795172051449547365900218364098620672961343411789571387231032760883101963385203709557021) #(1517933141227690305735611564395610742935223324239070359676263815897412455586810051784062203645450) #(1034047409885952159710033937882649284755045617746326683509862945760366610097161143240195272747432) #(2084847365943564299475097692394147388589620388093255063474414429782789279871297317245581312702301) #(2081996520138932993367538385156263726960215826182769861875926992346013519893126941014878024331484) #(1647767184313710781699921671526847110184756014917905672841891448939244506631913054631045924645261) #(1458826447481057785575535254613403875923424334159283904904366635401673530391995879698247597734068) #(1505789024036248975375226263345635235586297665199863680750630906192936835500623193835678319998230) #(1362658995604552566234590155734261654266303382129849401557350163936301051006406239049530235726351) #(956852249567731948559310035744327609766083141713461974751904622673061306762763388193079420432756) #(1369049749906701474345618324053917891468526978324986704015268939478231182274952032157859146725712) #(2010296672899415263600612679959832833943056591219219222754694700675324584439026218878162887889434) #(1174971691686911111727693819028807316611276850460451495584717565478228975714263600453986227498345) #(729394693263117959485196218203079046068326900351104401718877184198984216257349415604824272632377) #(436590020667555053698699955720378101400156014453099404555632094488887627543181038874066563039438) #(1211559872884478812378082209828538435303538155612709382440392520578137605188524006131138657875767) #(2107474607159256318303217025769353423425693526852519255521166716338081110166426686230101782222071) #(1226256524258101802600421294256743982112011838999261512415478549318826976751603892411693693017562) #(436079820084095723840897819352058070284779575156041262856665069401926454255099798235338164046507) #(793799286033921553679632734032634756884877958245075455641367152297036269313089564648080795337407) #(1733197777424785317650775739524348092401817987325383261626009381414712951174942280352649782463394) #(1100767860393388997606973657892066779886737567054594476713695451976792062901748416130345871565036) #(1787878084339965828909378027405608752525553120361731395721486937701390730249841197897708804874640) #(1565921822839822458247208022874240383439411316198334995160474458077179624976638261373265491355282) #(1762608468784184533736504612265335009638899016708297440586716282478774657552517487588247510619312) #(335757068810035662589324615797059385045569344309065318189865322392984118657331586861139071841004) #(944981648117179183238431773556194846744103872727209317601232371869780767852993403378205927503417) #(1947437072360296568980988686044697920653858180136908272905482310893083838014166509033423426295637) #(729883189639507332825548966860223465776964492924064446590855915167427823697129480820873128718028) #(1152295207035144798548860508074062430715755917535757368122337318543881968907247222540475662366977) #(913887534554665472654232520533397743238895623790134567600717481918608622530133579547512760462947) #(853803269632880326019497813819545756855341057214404823630716745682640461608959770904309291809027) #(1594175735413814704167130819096613212055033913040638672346843147873194936681569560657956305160587) #(6582907185126629486989381848906584388538866644810021606946857131619079329393632393131006158895) #(1316270179947706138031901551500948769919476352887269777829064102687928098578748302085681170522811) #(889203435907220633141335166746632936943161616375441505188636844271484986397910923904668574056180) #(258249262489632576249854471131196453168591667103372110400736573247772635779722277427246319052017) #(1761057272633514541693776369795665248500157151092311635199915032114976916464778524241118899280421) #(229136606637032411197795390299794766087946216472736245377684613116026146051356502683451066217494) #(1002465254828368176515716071432625496711594479621021084918572822811699091664507005681095898879262) #(1437113436463845147318048795010694683555265443519024408353725934977438975733640123369568366232877) #(1207507148285236726250854838867807787853668134745607982021994033618037193051266419712206122282612) #(194250762203640095020431597612831503692246174272085149615697515316427759577765111304795874689207) #(659379457795433756522820140731746888483203007148885862475607694266422634547915463189474947446878) #(133918804385683163404777964926458038497666408162378196609601471955390053187386827660290212069691) #(911350126674960950916017224145275816267015442623388166477661517908156211309661023450715761430357) #(2079955280974495500984285410461156353697524924663049626557127285286491757062577793164101156282521) #(1558927835224551686240986426924638259403717092565655644436996097359387594319197017601455141706686) #(443952266266321607656294874576220076494399329050605264710815803747025499870460068398506255335412) #(264139323736230832731196741353907755280928073392198114984911424768137550606894410051092430919645) #(452829372056878316552899361541049542918275346967065162518181640029966931072386161378259030621489) #(1576617666714201578656054432855126199932177579095249398489727498816919243535395046081548178612039) #(1700402601562096942682120161018463740377966046042590097931020918206843914039825048301254572961262) #(1936559348762314708602959432989183853418436445858369059535372269160397257733018925313331705968743) #(850547550346456567722300238802757584078270144034731568147418730485376079673495687167944915225787) #(1219234757430532468686793342024214902174826749662030393987870443900833621929359981290421011997776) #(1117579760987405744203008397301378189676394551962249423237068515053852619558927777751120989291016) #(792733955273282354312507398217903323437730359010994099379692656151938822825145203560332901842092) #(1339777284513747461646705693819833621385349916767654210340069903028374122579236585321177665500574) #(539648760807620144532854897004006379059674662083557184868674800845051511325946060843848885629160) #(1584746745262789134974577444770412230162408693164589573279154606458472924306105358376072114844212) #(29635155798939394469650848242788046968651959724375245195676891709773695731202256999743570359948) #(292694641494990212119122582502867188936790551322594017164948452036236060702654942094375018352078) #(1876060845347329255891666897129584137835887598060815145951356416511582656538021456579341967803752) #(136075763793838963044924734167354490578409612322448528472796571484051989649944675492797666801799) #(1367071775327227465908581013960549195833105455017585215611212003120127057571719877573315398718309) #(1961435089032291528854259910624818584128299665437416072017423938468998484158904746012844012817229) #(289940821803162165025182033765911092616412580822700026336375718880789718157078775806375596945469) #(171637953971468309568865892027211345044083687606695572639996115966611907662265660999595768310687) #(1636327346494205758803746882751682379469077684995559054884521929639813373156372760856431328110154) #(761902437005374292858537322501518171567901722155039078924859283921264090549878830058638974892331) #(422531794941763928612872948172084241044741044428657933055582830550467850358329444881017497300850) #(243709509700585711767012835944906797544159076525659738733131099562721775953973496192482072545582) #(2003359808961073872634211200463869864087357083399102970851565407655940690263213345630635122533867) #(1824307269140050628746803034025307167119601312245335683038483220712026231562947137142600219642156) #(1476588674753258079963758436706828959215522016564598190802736522108822216016191995755961321387340) #(390857005899333331504721007805733202315953137039360040548082422246594131223849512101329470263894) #(2134694815667556279893472132019260642476460961878612619974368713579331848845889816005172455941705) #(119946678273412357400706867669665841068902470433456968724198613314554325950993688837372709882187) #(1186330614613725289944464382578373228554431385170916689246891702788494574496800307062527355282096) #(1937074355604709869142229158252785027680382738596160602193478791928244731093180203024538028930739) #(1977189288882217170319873301915235400775278940008993297327256987152192077901566597749498452451544) #(1223118852806828228645559017977601577413668768200429463823141698510772017545921801477067544058881) #(757567921313120399112974097283481696536713457331940155036299759358824018666361540428312733289567) #(2069325789870238120801981217619589390360123281763437431331439734348675994734234827502090893053432) #(439850624575858590509213593966888419560516160393428353038231527512476710501432914799240214976919) #(959724628913901877302920839223624524263824876406826295373064946528972472071133935664325103058464) #(1588118547739564610229296791449942805664476043711058319586444973911253141982430121981549129483610) #(1940243747592400993878016432086586787132974849395051199245466402352318283783284883516870183367456) #(411036203785513749304803253871571568698840867507300918199436588323064139138695940801228196642087) #(770794737433493660100410575531095832899415153088477691822148127367556042829679347359057166096588) #(1421366247762789392049377990938832931274667549504022400698583219623448785803544639738733327523774) #(1475369638384858911590033395758864837766034036209143264039699261789547689451379792604181419591667) #(1761812597640504523224939918054575781960543077963586243938435122676649852936584913105277420639227) #(998004967304160798107392363769097042413311090619297315723086167889700472999582099439182309074375) #(883538930361213697317488205571976562665075251398153151821660266821367110692696684561828709365479) #(1464093357251497455273690101061625780253977114585172718296481365562862359942837670048097377091274) #(1436566417432291193176913786043124644407683340692036601681792733970032998317615627859203842565379) #(1477912131117278557761137045104368719982727594207287535885075875917983667166884831548085863479146) #(769957822293533869530419237274578574229040537070179655740972887201273113750136038071063804320562) #(1475326272999812765044353221402507449904635114237560734403004491060772459752621480381365664040966) #(819211081947351896119271236569640526499258102023209072031631408980904926246516664475291171575785) #(1707401990058340639815505734782300881528127246032358088289999572742835538080241955587345787386405) #(1134668626310703141743035704541371093137360264373968208049225995165381854748148653622851289174796) #(1063785677205375404049155488742758971130505377220695374040834983442615726610328114164358883919748) #(753073487025799651830621037697835869823567141130961784856116511836942127676395849752364563794081) #(198367591533080046199330865004735677923932335256660554507782729839785200231073022979460816568939) #(1034909014114073413837225735673825082119021090282896671799383715685732838354891580843103955443442) #(313422036999978414587032795762061141259075163111658979618685766986561102893322739157066803614718) #(1432448816820128213922557261114142759102353305013612625543788737284527249684348824984256227513114) #(1375205851932287364621971628834701351899922337422874345442372778709350102795374147974336745004163) #(931196336249075279335515636672993440902829187600860157661862046903612384312734191519060243665573) #(2047235565692736202360139958297949653422979123550373581103131210344929666317184712931387680567647) #(1216693467716001453393297226392280222058175989389203280585992044252237498189209526695656232308209) #(2071128412816543613152156848026725946737447281212402491249357210192386007011221604478270140018384) #(979237892215825692230092812562248079693511330485153418341462146511577799283476970070125727701810) #(608025302423449255032019521956949248332896921605066791338765326761126347699678756387638902910408) #(1544425440125013577560616033331460359854549937829768737317724726923742502734991214834046333105824) #(714083919131675601183981685485303114772219570465971692909140424994033273520090080920852237633898) #(1236829336029415700957525861471232907051351891090413647521837841639697706948540800369967591652618) #(1210280805914309712497119451330896731743032465256765268283987004218686346888162844724565085157355) #(1015692925969890621145484439854850121085665443436752766728071338802797891103121112357475171996322) #(1049583821259668785316174092394858410464920883844259713089351083832449370620291666151560231680056) #(1667717356391420710845470326999653351683803532719077432700974358279413655986595652841378457496592) #(1489613865602498067909703837423439138880637893468506828909778396295055505721970108083652431664933) #(65233203540709031902386128805600212690996618043512547250771103180899432724218710764121612250183) #(1374121925601917859292879101055412308266541305215560245363843623057077772556247385735792550767377) #(1013762356267641972360252930630104339724839953205792632146484715369045513927453449574146902598561) #(1221501287493886549666713223518921560669085780577145855748814888837574085762337214050429272837280) #(45391285277528629558763504178516281506492798347465423170923852669066289356202240442739080711994) #(1081498485005306120632105960363615763083434401904940883246302072626080885988607203452222046637771) #(1344804650625624931081639657770878472112814764026956898425601821588474325930875254729994549088493) #(761109631754400688171606097661167559572868350410653716398800180069980406519424647399313161480037) #(822363263597318501285198494644393370616179034362414805886782518006967702566937034547670490030198) #(1765675521901305626899718263610732885650534323688796959858497412019595466228496946016650371434304) #(264932344500915962238133998113678896522549563129651475581796325216622545459082695575858488851036) #(1806223772316160088648916162241464897238491815886478429718072873230009346558229934871311127086246) #(1701372333735809771171242642796214914725320589101240306755788752967099250542928959241415585879233) #(1180323767034228569789191530553313419265977095292787121847838753969399302775677986117324253629180) #(590052359384942276261296641733240841261274323182624098172929596845693337068814642101904589090993) #(1977710039343162768620061149439609397608367376772642984268306415008969270205953260934721022813710) #(673853120683070874664290582860185808539222848041918357076628360759124934943971964861306240072753) #(61377519668224492157801079169412331866804613868893526601535392313359180923941356458569106515285) #(1083165194729969926100022163698967891194045057026171707402935667441359226069187159750177619662768) #(42844902169636353122389501483932906267978289981456296961851126203052118267974611088210391558730) #(726577071910134749342390837364605600251902115153873573608223111990246351197172421936102119704834) #(1447076701339112925532555044374299353049531299713029980913676920093852774190388739587011558473541) #(1688743981048643112961663208363958321553221488148218377084334587790641617648235904285425108052648) #(1527084638438607574659945645656015779852804386015275605981925181707937548138612906042919653375197) #(1855946010860827584332493823229229190441395333412067937745882830910209289886095530514245075005081) #(432488939103835402464875320152405109813388504342744291343603512099486778000049426078682933242099) #(1568256956413773335216513695042471183948612995371707316018515051826860101678571245434279161915147) #(810556022148454800108958966365566817860044574681167742223060843440900535954813230761027762141683) #(521502889833555675137099033325833574941099003801717843584655808783817838376970431542301193396591) #(1394353689188320540463314014015655032881867857822638397414960578215143737500275055174516648893122) #(819078504626309486510835536203623661868481804207247649534516581763830536961923210393476932565496) #(705893553710908441629302267899514406853711549829555888013258776386532812489809178575496286312271) #(1587633384073863283983093995844228219186528328952472662082364267275724802615134120886784844107688) #(225424813148696742160752695995208175072743065504599807696457466741684847835897758146565368473017) #(1446552357875078468833079883158308398501345361511335816680378981564829626489733029251523578578773) #(2069271075871408518442634033663917402216924413824869409122861415295359404354424987520141810757193) #(551862969734978012074555903813062060333200664759276671525359852131386003051305272568002604055960) #(48175468970692190237526206726332996924829923335949594069230309956750737502732392252360350126935) #(1406051777857734071765100221609828201185969375032652225326115775926817740660464501142266020049483) #(302660032371734240658445351610175862825103707438646562359636125300775812224726462412804220202170) #(1311573760239664608435807131287859828179663040844058333974548077392987049845080502976228052082392) #(1312604342204679362039252615142060286078520313526589860533767157762710040388311352979864249608827) #(2023040714134294221417802021775672880308924598927421410090497031641936339489507690455472499520782) #(1630303799113692932814677814919399936516059632345678481139438350235966133029258499655076769308774) #(1544016360009317436940567730941865950426563515273003672141198885651485603583177088104932668255880) #(968681525378146505480820818833266104874714288458370130871721705759351266340866607932325543219672) #(219691258419869324527808302818404918421535302702768348874103944605124341611971691658535241910118) #(1413308789967839088142616251907507381237408901073249837664200885156189333866043313072361795746693) #(433187176416733615829819483856165672753294064382972956217637699061760094592431773175863680604673) #(647664407133668427046817026380656108510044898074966501815316227876281362805645156534349976687266) #(1451340367574250474624051954338304301764805968566687608613216195446750448007040830603620977544921) #(888922819985521179480953409484951038635260352096827849185499604698419089716077840970350829856843) #(1735243809209469777499394334305516187871538964888273302810659698350535632428036200508454235026039) #(1426389433427948589738484248899654429682823144011034643101564164406394614189841558005414049230662) #(282424288218524029045062354698680088846674482776671615394220678855112898874616337394250760152411) #(173797710343017436068113823260131776251845914718586826731561822113217818025136113714342754652454) #(1468743563207237828669327905696010690688467440060518616443566949733593383427412797199239121551221) #(946650430142674932821951465602282462460649428214234887559490395943785595896562967490119178695915) #(1933806433190038373661940018533002372405402388834064325465751823221384103773438115999883891344181) #(278521301010174710401367718081363727527915061668501314220842032243371876517443072230785629638157) #(360608261432507330883290048758650435449914535090706947277464136469993591964169289351352476425762) #(171903102856929928988852583776798641610860835063481738194146308821757636332480180245042099850812) #(1605459968840867727663404683235527204634148902229896449563321873923767623602518026466930418022884) #(1216406077536373881023698856351827364357368004107188898775988553435324686919110854472414875226434) #(1512146350097648726674437940147016503428446654558119846494928097909396102597394823479696720180954) #(438242218195473525741392786561141960429291628201909945827821320775047300538432100187923700779118) #(1530479068741780375948431430674560300613456469434095765066659129434025780877953546561374142986758) #(1685004480815580780069685784585380948882402626149155986024443731264379072944851292333420943900761) #(768447794526995404479676654523024150319698826432894091746722576476196870071476337388174803126965) #(1375740679883604666251970373725078306835296700417424547697491853387378480219410683880652925615169) #(1666569540092626513485016176115123832152554488785816930377834528523458244894362415947628299774273) #(1873722456364957314261813914885919648918226225506820268140725210635237377548829872789246405541806) #(2037443911848750141701669596406463962204608588756138471939270624447240532334931604893833225293767) #(1941996000177357071825929825013185415501157761592113366025138502858573977961713234101536052533083) #(1238149838848026870691156352397934960660577031488239209235428122353430222885086983578754832378222) #(88693302284224925858824883748883843348455363247572626787724030171372074561810523635931337325365) #(226675532157785228483228416292100603788367499193314759420678880998954138954735897196218284542573) #(266518348430632368345005486572928388885255769523427665529489566713470648720607801145134731108526) #(1642101734411809572477107639384549031589765959423782001505030467889437433423587002198908763703246) #(185125258343891949557371706304610717819085030287539903948706259194660319800671187311470776281458) #(2003012789918316445277334452978687006479137355810093754099342463793006999613199221499168830682141) #(1999995457256246269181599503091480986691015413127270572418402698516866409930094074456218894844176) #(461363646881560039145748700151400982536272657671622742078868711219973908347351624361789934582328) #(1480929313941022284505730855289013204259236726315997686900298710744632207002322365665608089280585) #(2071866342171637544703161073401442399654700490929099471194173112874911144575312301711504873135203) #(1791253129207119851427969035672553715394942367340638345179117157164818715414742254947960072281007) #(1056327444672739137313469271680723541609959064128531445306243810979073436766226823556948925191107) #(995282583442555736375608892936398704399873395519038649094219211661594902458909145423781210051670) #(1175010490846635862131264620120235967630293634892260080749579680376527242701214174596727601034733) #(1319319255706662324124237226985973396231641391985488797315813614488976552049964116028920437973337) #(377068260467936205918214152118645365853496815561244837527512358384917324158053590948683411905425) #(1122960177569739594825919496051476671732891883623636344125852619520171255115496139962395210953069) #(218758880378162530068584856201728384184525143901165468945629951256105393868452792078754861918186) #(1750212382898977107511480991586336996776302177496102265560313092035741775033114306868100078434463) #(423377979300828996513072631175458457447892278381926190804038848419667742465110602202119298925264) #(825857378124576978537167328212586783849460189857308074256640265515401890093440979166704075685701) #(969987539664213895071814587811258616595185733582516550493059380413682520729787884322803689477264) #(599532171427374498324636799331324457526953616281441660281858156642860365746882962820241034661895) #(350327359455775441605586273828699192300645755730791928467587499664741766189568025072797232682490) #(1969022086618272070313489143595116396265820871772267256976959068072563294445029274610290890617065) #(654262703737049974481152955619536669937247696759436814203705574146643405375525570353514304262080) #(1968012634403522668576979686947564340962515956994808521282620053522331759778660902924954491906716) #(1942097795503930298258906071615256606157784952566938920236779278759311640706509078881284646947167) #(1806130901731910331920136550021474959740799127847562527530678251245599954391132695480856795142361) #(1531040533846543595232869435122749672986782447978798482643116746690485311919140389951841483138266) #(1577284062364834719230043441573851220786730869946106780998775359997645067013016611574113566471311) #(524704480985434197634759007539955456326063546619822559174024806201210925251417180999824490242950) #(1338021447540475238661037608485774003271862583011825671529447043339537338035950156839600889829514) #(1117059312476479179732700600805943582919155223360338137978341410764645695231339543394032739001496) #(142442901124433652640346532109241624055276321965953234340801101026596972042393934945409046189887) #(1686644795010653304364838620808515095880025973819144466304616654797438608671134725324424616657884) #(896499347365473590635701048253736238385221967191365707108726622525948631281533104326432750863711) #(302867257917992365026414546275880893169876482372165711340775292654872550969969949373559171734322) #(2027015204136258069220330405258433958061088787528925119774647950022465302539348968755960763966027) #(404023794726670951851315428960878861360143238407345764217774732998114195248928763097640465446326) #(1117598039190299577440533049958434533481272357553493359061656177203315322692683472285525576196828) #(281499923515752087666874612066744488473715429089519747498151063094738426847977472606219589333573) #(2003395514936326719645472294762337218176410335721016994868982977082358828146092253584288594092714) #(964526396263620464334368450497586512284662073467635705380473123619266018147185188856990591795138) #(1297189103650984186693624686692898273648925629693214586562866574427261221073495953163757560944844) #(1062362683229913550943265118561636376010436674036653866053816826032797319201724100690056523336342) #(282216350202590296262615021353198057414991433001442302395210997973905338066234176653961997486364) #(381355463631459213242639636720952238853386633325257879331737579965839267291202915251510373019303) #(926571053913015020662137842378911970760154850927708205919761018245374560564978462336392399447202) #(2085408369478181786836337870439081028527195732469425310271309186345213714227037070930421628000586) #(1542756364133296968089539276765983731033971886426613579708801192863731710577923304221093092048507) #(756749642749140779866829289074401168791406994547176960771616780959876778339343228095534990816474) #(429630904206789393016563133636909675692552887173859879881625533869647642651657093149030712817576) #(1566173176485594469197113244506338496995637812927952332086107093007962325807988903447170202502153) #(2030472962160855523113856692014034498972359508681633348424931389527971715642634938576695114056200) #(1481258873250286467202001383304813426273232507301779848420288934029045761060140699541538027649184) #(1365647668280870213244913570175400384090834611580051830271275641571868890971003073949480299190927) #(2033858889248434954925010031498112107251691909649283073832673758115067951918280075602937147647468) #(347145549764109898094374094931909192214015549819886181809249896080979929575724626421217690612731) #(1488960110552631838578148032148466030136788473719134684388330337537938957794648321235256349599288) #(1837628420562240584786243030160129421737736884899521705540995191448803768312029016083570276589665) #(1295748009448958200098934594144061980697618670582999914144406043697173977446923319933955024767399) #(172340823765481308158203954599237846320157870153788780297355295943451249504022817168010829779806) #(1378269596630801104084696978645890131186465205240666856060342321390687305555163392964200694882974) #(1621093660893366926170733829699029008457468442740492089318527878705385806124604971327447902790986) #(316518814621478886106544148439519026273430537787048809744717812263641944504540370724387178767679) #(938685069563687836249884541644050284601905946921428839897064519968403655276894574703091347742872) #(2104004547153703833870631787599566152262784200801099360047280295556208783647324040128570129478919) #(1892663256298062680119769751145071656866650545333866210413556131148911584421394261984680788123262) #(1647438798076203714478998805183371451176302244391908623641030591367400004670423690845499900508800) #(1259513714777606413671069974779562609747878299670654621056740808557995195021596335814954098171799) #(1983033804760081552355837663859760766694599397998741005423109926543304393610049747207326104726476) #(359683465732026037946289355082345259558635301762194849567253526381063232651821551733713727993324) #(1794996191768378143071372657354797266059216513503693208851129362201909437616016177979188833186158) #(947440191581789031651615430974001142043331781340163626233207782506737392117821695618027420363916) #(1092650947976417733229637492034186977426984896637936071082342901347668213467829205056215627747693) #(804509415144357843747978902031872515155813891555903170206225262448936713984475427046951760745948) #(594331496451924975454380205734317615018698117890274671859693612197571851217804475179373924839567) #(1958575130286308425208250913337396829192915665947897914042048757775658161845154716885684008744877) #(2049428861792177670686938069271423683217972669066363658457267136123294469600623279047166204001018) #(439908077966910225957032663194146062090185886335735780068755943390857704320208076274660648780863) #(1741682675121990996908621445282992756218863652754706961319494670318010923279044680443653353578265) #(384072153052230421086698537590457823449772642114364304534348148041216568556280294805326223762325) #(988767478968241764241436287630040850272508358718953286661471099127393060331869395922756687442691) #(314436394796951669387127178767812726441565065730387991328787262727114685138095168691647662981323) #(321217179081849409332133722401871493391027553749140033943537398341122009473076825717071360595339) #(1267216758916745565666045509754552545275993692729112582717924491100095869741107499027470522966681) #(276275956308748083745085621323816402584096485703498820338031710872165431524189626857066863091877) #(371847140854700727425654035784193575473350971956000124374830332616629258917512806370506432545768) #(1323630924263191869270478660458744752850119923235387379104439107206176493485540328552442836857856) #(2009213304395813615833272902416398634241096495961102063046075302706987246262836747781363913415911) #(2086043894096299799356276109278807350270517111615297949171926057249547015923899145963224538551300) #(571949875391872694378982205152720995267438850835805675595634206170616475860679050220095461413707) #(1363122799786508101989756830256352081730800686508161617149201027956176287782370411794462673684150) #(881609269228669508256887201870019101868409255108514337303396189703785631192477528072530584264394) #(188263183406362684454819065185371820301793594927769405523571241339570598840069168572602085938248) #(739242761234177594959256436229508232640499083453640481565610885907493436223691068807810702682513) #(207864243108200520194455611796344165676702001531132665556316191417454385224010240968303648660037) #(738343074149615991692526206374753388485669945826946274936947447898915651046170527164339437319897) #(844052815195532298255348324906695761575567700668195272305783150804308014367776647085160907355256) #(1176385809198480822058430818944644935815659072718201801487786195094473553743725314437617435174648) #(662039553799621863377788808308177287579151285035477630913314236510226743348424761954287029064442) #(1577321999516705603047636745586428565178976103442790521672275646329127752649669638287006451121185) #(1143029674289955952015591764715515737752849337140801134693181705171311013860981931957021512662946) #(681165281667358310338686080556981952144950756696643013239899523691668013729980132059646610810678) #(1926591485527738495318178095673036673347354257414210898849181275665223540792294304658290785424345) #(1130125275418868953821683756663274809396271473832209649859126650063434253382398882428101209442526) #(65080472285155515429360367236216281820807768074863243641871115419673173264302283674703180091896) #(934072399782708168206867746091627953665846323148250636269838075787676894906758978907147867363104) #(2047468832551223067736199699975273077674038186877585612285848688598468225568308301678863071177767) #(452131002253146137155038230156485611855258053056818790580434968345796871823681262270581178661786) #(1760033242476781181687485005984450834298212507096723265651871030580372432604534635331066813249444) #(1165354535119261916649320774589463551664934012805647829641344245089723146381055145607751317777774) #(482906995385677333835639456686949545251693018985877140048286766845380610523163134993914471872939) #(272774790242076209114669397802852357601655012639011520766512981657864432265149436606599328935038) #(538697919266470413270718464815368689173794261416426826356011359187212579164682760734171764196825) #(1229721540089254130277843967569474032577603043584003580111084407432781198256612271913962963103185) #(1656874460134675284407830218464302221655466908327764133228465554887930542294307702034727480498589) #(247798882187887385514544772023585607236718216614313949475465684072245813891110885670649712790249) #(488570044074865230920856169965742642568464054644255219066521577503690281490183109027784621488401) #(2121677494834410960100481817822025399780180730106801648491555474421685682610733566791128977242639) #(1753245169467974287394853547597875225791886881964060317490184020362200180393600215340047185397039) #(471710688052629750215815041208863368851009720802719527282733013888822376465922777189294897452967) #(274465854132881490409215093515814051263066204813585410368318070987568179220517957763421117181212) #(1709847344156132471017624924870090532167503054188261638660161556810902026134400872806024479149660) #(1885059293313527917328705149234513920513313140433703650769752403554655002152911290409663609385890) #(532000514395840575279789251916203486827969068185374478499863110986315792391505399181063851771339) #(1318636173821819612194727117215375731946954172156180047702214172978756324804537954740962094818320) #(998265518384855537299505232995715155298665359520889764639185956463566258634275066655230743596482) #(260552157119569404162685886841507844053324335632461051957129986446256728167402781241378477499342) #(1739066548077428155293624464522882432791361078900626286762295067310626904883244708283779745070378) #(2124958363534636514848492433869823548285243262246453403607673829438900672735198676871601363528550) #(1117837770752069607830035346639929644781574684457862504020044409591121093438423477424569927791864) #(1505950461353809764930227051376506522362830004852332693705132768665758458559145465225597284476474) #(631590972366583003363865028200425371390254265757585260414024366351311749233222550785408261867317) #(1282992321072296583892486449188705070733280587364326012931772459605716559344262695342514921324334) #(378084297739912871901543114825041006746478691547880418053217559413520109258359352524271510342674) #(1121193744238401551108485865149239372148572210420182986471409480598551346720655323831551925894245) #(79881910767436720269171971923179915546711385415532827244392290717837876364957846510877880327642) #(1110820869452424721557526200294017338252692382481831222480949094616404949053407526544571565889440) #(776737830876881982344476005882772003657847303218238814232433030675694410079131514074948107156446) #(607622276196019662524360149192712643637970412748993183873907453026116039295655286669126418941551) #(256722741097462113476516441332611578656418328175539647428760765801410755189427369620814620014328) #(922338217362084671188115261783242137234258802051707409698406010782981011470754273025130646419334) #(830734267077125546070156663661879253256476489910893898699656167053925286076200078496040567351620) #(1207025442653893802449282751249715775807987053661716139391127618003147400055004720819416108570256) #(1925732781880805063645680020281063968451685489893177923006746130492807821549225203132173356598020) #(1366100884960420137949598750253091079682176037259192777579421485647357705951092219078190062277227) #(38064613536496535113262170439088091353791157100298373270228074813159017667435083369551552870284) #(353367071118537190303569334547915121017774760632417045018015835894243876094127065032287570096038) #(758201876250728843706830544436636349058672937125708727851346738710643988466296172411867591421309) #(1106203155808781511894242096835989586204479520463366868841057838073411381837299830846939447264194) #(1660765638017688188730985992775821441424923135717761403009056290895076014794541664522984373499580) #(145660346881693423206258956590761336026683996886363556569135112836056601330323856300504730032891) #(725385537715125737559954785642711889456681385466108377670116504652279100974405576647680994225691) #(641962878153674075302607392319304993047132864845140270246871769102898474243832226936221988031822) #(1132246454564314253518422334678753338519097303443234960660329113040008803940382712515572267462408) #(79345525567006277954861368542763297979244126515455720559985657574166862775033562555776149633890) #(702231127929414816266056312069704898105228777663340527597078395148526457553079503051181148284) #(2052294061275014759855805181633788208098028133616841386977038584275977552506248962312058363231785) #(501650137050617628516640281023804948058077625121864874785846973587285709270861176496265874989240) #(1474771782102899723534193292466615329885255094821866291933649933578795824273498133945962257463238) #(143211796960845234471830215368102968138795608704181022029750298537792930893343061805696755143340) #(349734421692785792204935060022678870020676934617799344567945599596325282231134768434879653321271) #(214261957630915938101220722072333575870302190474835291770005302863496916161811207082065496638650) #(1584291105968471145709811442865291561437043852294060732752788145421945204205157622560110817711313) #(7609739470206945971877203578319064524917450498440385197071441643890239633229577686921666634708) #(126261535301884110379562379258460083294901340372651395531736321459078481048134956905079481061283) #(976879530736697522150928008353639313696871780095403856585457959212472260313141708520941154496047) #(294984175959547038590606762152079676953871943379627492145276916053514092581528502093875120564770) #(580979551236396346712737885220860875610723313673950689030868789118242914894058137090525626680479) #(148347055961531997597800415267144194759491713885101399676976887108464758015986147151055237278591) #(971244793279193396453313189988788993998018124988955703201324587554955068470373142060189142409039) #(1976414026419065167080515799034531564504384360869904307044688145748495786050657457203955215158354) #(1915301683655361020252376569742641937765096886243960211700446200917997304002738430586070228760311) #(2040874808924149760037570215321725190733104452457397181240002646325564372330843017940011485697744) #(1733833143803882776757565218764879445565916171542512355557555716073469792508880887759770466038688))))

;; Provide the Public Key ID
(send kvdb:kvdb sink :add :my-fpkeyid "{B2DA77DC-B596-11EE-8E31-CB2DA3737401}")

;; Provoide the Public Key
(let* ((sys  (ask lattice-system))
       (skey (ask lattice-skey))
       (pkey (fgen-pkey skey sys)))
  (send kvdb:kvdb sink :add "{B2DA77DC-B596-11EE-8E31-CB2DA3737401}" pkey))

  ;; -----------------------------------------------------------------------------
|#

